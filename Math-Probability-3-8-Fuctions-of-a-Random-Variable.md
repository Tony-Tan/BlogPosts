---
title: \[æ¦‚ç‡è®º\]3-8:éšæœºå˜é‡å‡½æ•°(Functions of a Random Variable)
categories:
  - Mathematic
  - Probability
keywords:
  - The Probability Integral Transformation
  - æ¦‚ç‡ç§¯åˆ†å˜æ¢
  - Simulation
  - ä»¿çœŸ
  - Pseudo-Random Numbers
  - ä¼ªéšæœºæ•°
  - General Function
toc: true
date: 2018-03-16 09:49:24
---

**Abstract:** æœ¬æ–‡ä»‹ç»é€šè¿‡å‡½æ•°è¿™ä¸ªå·¥å…·ï¼Œæ¥ç ”ç©¶éšæœºå˜é‡
**Keywords:** The Probability Integral Transformationï¼ŒSimulationï¼ŒPseudo-Random Numbersï¼ŒGeneral Function

<!--more-->
# éšæœºå˜é‡å‡½æ•°
æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢å¯¹æ¦‚ç‡çš„ç ”ç©¶ç»è¿‡äº†è¯•éªŒç»“æœï¼Œäº‹ä»¶ï¼Œéšæœºå˜é‡å¤§æ¦‚è¿™ä¸‰ä¸ªè¿‡ç¨‹ï¼Œå…¶å®æ¯ä¸ªè¿‡ç¨‹éƒ½æ˜¯æ›´é«˜å±‚çš„æŠ½è±¡ï¼Œæ¯”å¦‚ï¼Œå¯¹äºç›´è§‚çš„äº‹å®ï¼Œå®éªŒç»“æœï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ç§å‡½æ•°ï¼Œæˆ–è€…ç§°ä¸ºä¸€ç§æ”¶é›†ï¼Œå°†ç»“æœæŠ½è±¡æˆäº†äº‹ä»¶ï¼Œè€Œå¯¹äº‹ä»¶ç ”ç©¶äº†ä¸€æ®µæ—¶é—´ååˆå°†äº‹ä»¶é€šè¿‡å‡½æ•°ï¼ˆéšæœºå˜é‡ï¼‰æ˜ å°„åˆ°äº†å®æ•°åŸŸï¼Œæ•´ä¸ªè¿‡ç¨‹ï¼Œæ›´åŠ æŠ½è±¡ï¼Œæ›´åŠ å¤æ‚ï¼Œä½†æ˜¯è®¡ç®—å’Œæ¨¡æ‹Ÿç°å®ä¸­çš„è¯•éªŒç»“æœå˜å¾—æ›´åŠ å®¹æ˜“æ›´åŠ å‡†ç¡®ã€‚
å¯¹äºå®æ•°çš„ç ”ç©¶ï¼Œå‡½æ•°æ˜¯ç»•ä¸å¼€çš„è¯é¢˜ï¼Œè€Œå‡½æ•°çš„å¾®åˆ†ç§¯åˆ†ç­‰åˆæ˜¯ç°ä»£ç§‘å­¦çš„åŸºç¡€ï¼Œæ‰€ä»¥æœ¬æ–‡ç®€è¦çš„ä»‹ç»ä¸‹éšæœºå˜é‡çš„å‡½æ•°ã€‚
é—®é¢˜çš„æè¿°å˜æˆäº†å½“æˆ‘ä»¬å·²çŸ¥ä¸€ä¸ªéšæœºå˜é‡ $X$ å…·æœ‰æŸä¸ªp.f. æˆ–è€… p.d.f é‚£ä¹ˆéšæœºå˜é‡ $Y=f(x)$ åˆ†å¸ƒæ˜¯ä»€ä¹ˆã€‚
## æœ‰ç¦»æ•£åˆ†å¸ƒçš„éšæœºå˜é‡ Random Variable with a Discrete Distribution
å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š
ç¦»æ•£éšæœºå˜é‡ $X$ åœ¨ $[1,\dots ,9]$ æœ‰ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒï¼Œæˆ‘ä»¬å…³ç³»çš„æ˜¯éšæœºå˜é‡è·ç¦»åŒºé—´ä¸­å¿ƒ5çš„è·ç¦»Yçš„åˆ†å¸ƒæƒ…å†µã€‚
è¿™æ—¶å€™ $Y$ çš„å®šä¹‰çš„æ•°å­¦åŒ–è¡¨ç¤ºæ˜¯ï¼š $Y=|X-5|$ å…¶åˆ†å¸ƒå‡½æ•°ä¸å¤ªå¥½å†™ï¼Œä½†æ˜¯å¯ä»¥åˆ—ä¸¾å‡ºæ¥ï¼š
$$
Y\in \{0,1,2,3,4\}\\
Pr(Y=1)=Pr(X\in {4,6})=\frac{2}{9}\\
Pr(Y=2)=Pr(X\in {3,7})=\frac{2}{9}\\
Pr(Y=3)=Pr(X\in {2,8})=\frac{2}{9}\\
Pr(Y=4)=Pr(X\in {1,9})=\frac{2}{9}\\
Pr(Y=0)=Pr(X\in {5})=\frac{1}{9}\\
$$

è¿™å°±æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼Œå…³äºç¦»æ•£éšæœºå˜é‡çš„å‡½æ•°çš„åˆ†å¸ƒé—®é¢˜ã€‚

>Theorem Function of a Discrete Random Variable. Let $X$ have a discrete distribution with p.f. $f$ and let $Y=r(X)$ for some function of $r$ defined on the set of possible values of $X$ For each possible value y of $Y$ the p.f. $g$ of $Y$ is
$$
g(y)=Pr(Y=y)=Pr[r(X)=y]=\sum_{x;r(x)=y}f(x)
$$

è§£è¯»ä¸‹ä¸Šé¢çš„å…¬å¼ï¼Œå…¶å®å…¬å¼å†™çš„å¾ˆæ¸…æ¥šï¼Œå½“æˆ‘ä»¬çŸ¥é“å‡½æ•°räº†ä»¥åï¼Œæ»¡è¶³ $r(X)=y$ çš„æ‰€æœ‰Xå¯¹åº”çš„æ¦‚ç‡æœ€åç»„åˆæˆäº†Yï¼Œæ‰€ä»¥è¦è¿›è¡Œæ±‚å’Œï¼Œå…¶å®è¿™ä¸€æ­¥è·Ÿä»è¯•éªŒç»“æœå¾—åˆ°äº‹ä»¶çš„è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ä¸‹é¢å¯¹äºè¿ç»­åˆ†å¸ƒæ¥è¯´ï¼Œå°±éå¸¸ä¸ä¸€æ ·äº†ã€‚
## æœ‰è¿ç»­åˆ†å¸ƒçš„éšæœºå˜é‡ Random Variable with a Continuous Distribution
ç»§ç»­ç”¨ä¾‹å­å¼€å¤´
å·²çŸ¥è¿ç»­éšæœºå˜é‡ $X$ æœ‰åœ¨ $[-1,1]$ ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬æ±‚è¿ç»­éšæœºå˜é‡ $Y=X^2$ çš„åˆ†å¸ƒï¼š
1. æ ¹æ®æ¡ä»¶æˆ‘ä»¬æœ‰ï¼š
$$
f(x)=
\begin{cases}
\frac{1}{2}&\text{for } -1\leq x\leq 1\\
0&\text{otherwise}
\end{cases}
$$
2. åˆ†ææˆ‘ä»¬çš„ç›®æ ‡å‡½æ•° $Y=X^2$ å…¶å®šä¹‰åŸŸ $[-1,1]$ å…¶å€¼åŸŸ $[0,1]$
3. é‚£ä¹ˆéšæœºå˜é‡ $Y$ çš„c.d.f. åº”è¯¥æ˜¯ï¼š
$$
G(y)=Pr(Y\leq y)=Pr(X^2\leq y)\\
=Pr(-y^{1/2}\leq X\leq y^{1/2})\\
=\int^{y^{1/2}}_{-y^{1/2}}f(x)dx=y^{1/2}
$$
4. å› ä¸º$0<y<1$ æ‰€ä»¥ c.d.f. g(y)æ˜¯
$$
g(y)=\frac{dG(y)}{dy}=\frac{1}{2y^{1/2}}
$$
æˆ–è€…å…¶ä»–æƒ…å†µæ˜¯0ã€‚

åˆ†æä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä»éšæœºå˜é‡Xæ¥è®¡ç®—éšæœºå˜é‡Yçš„åˆ†å¸ƒï¼ŒåŸå› å¾ˆç®€å•ï¼Œæ²¡åŠæ³•ç®—ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯ä¸ªè¿ç»­éšæœºå˜é‡ï¼Œæ²¡åŠæ³•åƒç¦»æ•£éšæœºå˜é‡ä¸€æ ·å¾—åˆ°æ»¡è¶³ $r(X)=y$ çš„æ‰€æœ‰Xï¼Œå› ä¸ºè¿ç»­æƒ…å†µä¸‹æœ‰æ— é™å¤šç»„è¿™æ ·çš„å¯¹åº”ï¼Œè€Œä¸”ä¸Šé¢çš„ä¾‹å­å¹¶ä¸æ˜¯ä¸€å¯¹ä¸€çš„åŒå°„å‡½æ•°ï¼ˆåŒå°„å‡½æ•°çš„å®šä¹‰å¯ä»¥å‚è€ƒæ•°å­¦åˆ†ææ•™æï¼‰è¿™å°±æ˜¯æœ€é‡è¦çš„éº»çƒ¦ï¼Œåªè¦å¾—åˆ°ä¸€å¯¹ä¸€çš„åŒå°„å…³ç³»ï¼ˆæœ¬ä¾‹ä¸­æ˜¯Xçš„p.d.f.çš„ä¸€ä¸ªåŒºé—´ å¯¹åº” Yçš„ä¸€ä¸ªp.d.fçš„åŒºé—´ï¼‰æ‰€ä»¥ï¼Œä¸Šé¢ç”¨çš„å°±æ˜¯è¿™ä¸ªæ€è·¯ï¼Œæœ€åå¾—åˆ°äº†ç›¸åº”çš„è§£ã€‚
ç°åœ¨æˆ‘ä»¬åªç»™å‡ºæœ€ç®€å•çš„å‡½æ•°å˜æ¢ï¼Œçº¿æ€§å˜æ¢å¯¹éšæœºå˜é‡çš„å½±å“ï¼Œå…¶æ¨ç†è¿‡ç¨‹å’Œä¸Šé¢ä¾‹å­ç›¸ä¼¼ï¼Œåªæ˜¯è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç»™å‡ºç»“æœ:

> Theorem Linear Function: Suppose that X is a random variable for which the p.d.f. is f and that $Y=aX+b(a\neq 0)$ .Then the p.d.f. of Y is
$$
g(y)=\frac{1}{|a|}f(\frac{y-b}{a}) \text{ for } -\infty <y<\infty
$$

å› ä¸ºè¿ç»­éšæœºå˜é‡çš„å‡½æ•°å˜æ¢æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œé¢åªç»™å‡ºäº†ä¸€ä¸ªçº¿æ€§å˜æ¢çš„å˜æ¢å®šç†ï¼Œå…¶ä»–å˜æ¢æ–¹å¼å˜æ¢éœ€è¦ç”¨åˆ°ä¸Šé¢ä¾‹å­é‚£ç§åˆ†ææ–¹æ³•æ¥è·å–ã€‚åŒæ ·çº¿æ€§çš„ç»“è®ºä¹Ÿå¯ä»¥ç”¨ä¾‹å­ä¸­çš„æ–¹æ³•æ¥è¯æ˜ã€‚

## æ¦‚ç‡ç§¯åˆ†å˜æ¢ The Probability Integral Transformation
æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥ä»Šå¤©çš„éš¾ç‚¹ï¼Œå°±æ˜¯æ¦‚ç‡çš„ç§¯åˆ†é—®é¢˜ï¼Œå¹¶ä¸”ä¼šå¼•å‡ºä¸€ä¸ªéå¸¸é‡è¦éå¸¸æœ‰ç”¨çš„ç»“è®ºã€‚
ğŸŒ° ï¼š
è¿ç»­éšæœºå˜é‡X çš„p.d.f.
$$
f(x)=
\begin {cases}
e^{-x}& \text{ for } x>0\\
0&\text{ otherwise}
\end {cases}
$$
é‚£ä¹ˆX çš„c.d.f.ï¼š
$$
F(x)=
\begin {cases}
1-e^{-x}& \text{ for } x>0\\
0&\text{ otherwise}
\end {cases}
$$

å¦‚æœæŒ‰ç…§æˆ‘ä»¬å‰é¢å®šä¹‰çš„éšæœºå˜é‡Yè·ŸXçš„å…³ç³»æ»¡è¶³ $Y=r(x)$ ,é‚£ä¹ˆæˆ‘ä»¬å¦ $r=F$ ä¼šå¾—åˆ°ä»€ä¹ˆç»“è®ºäº†ï¼Œæ¢å¥è¯è¯´ï¼Œéšæœºå˜é‡ $Y=F(x)$ é‚£ä¹ˆYçš„c.d.f.æ€ä¹ˆæ±‚ï¼ˆXçš„c.d.f.çš„c.d.f.ï¼‰

$$
G(y)=Pr(Y\leq y)=Pr(1-e^{-x}\leq y)=Pr(X\leq -log(1-y))\\
=F(-log(1-y))=1-e^{-[-log(1-y)]}=y
$$
ä¸Šé¢çš„ç»“æœæ˜¯ $G(y)=y$ æ˜¯ $[0,1]$ çš„ä¸Šçš„å‡åŒ€åˆ†å¸ƒï¼è¿™æ˜¯ä¸ªæ„å¤–è¿˜æ˜¯ä¸ªå·§åˆï¼Ÿä¸€ä¸ªéšæœºå˜é‡çš„c.d.få‡½æ•°(æˆ–è€…å«åšç§¯åˆ†)å˜åŒ–æ¥çš„éšæœºå˜é‡çš„c.d.f.å±…ç„¶æ˜¯ $[0,1]$ å‡åŒ€åˆ†å¸ƒï¼

> Theorem Probability Integral Transformation .Let $X$ have a continuous c.d.f. $F$ and let $Y=F(x)$. (This transformation from $X$ to $Y$ is called the probability integral transformation)This distribution of $Y$ is uniform distribution on the interval of $[0,1]$

è¯æ˜è¿‡ç¨‹å¦‚ä¸‹ï¼š
1. $F$ æ˜¯å•éšæœºå˜é‡ $X$ çš„c.d.f. é‚£ä¹ˆå…¶å®šä¹‰åŸŸå¯ä»¥æ˜¯ $\mathbb{R}$ ä½†æ˜¯å…¶å€¼åŸŸä¸º $[0,1]$
2. å› ä¸º $Y=F(X)$ æ‰€ä»¥ $Y\in [0,1]$ å¹¶ä¸” $Pr(Y>1)=Pr(Y<0)=0$
3. é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³æ‰¾åˆ° $X$ ä¸­çš„æŸä¸ªç‚¹ $x_0$ å’Œ $Y$ ä¸­çš„ $y_0$ å¯¹åº”ç›¸å½“äº[3.3ä¸­å…³äºåˆ†ä½æ•°çš„è®¡ç®—](https://face2ai.com/Math-Probability-3-3-Cumulative-Distribution-Function/)ä¸­ï¼Œ$X$ çš„ $y_0$ åˆ†ä½æ•°ï¼Œå¹¶ä¸”æ¯ä¸ªåˆ†ä½æ•°å’Œå¯¹åº”çš„åˆ†ä½æ˜¯ä¸€ä¸€å¯¹åº”çš„
4. è¿™æ ·çš„è¯ï¼Œæ ¹æ®æ„ä¹‰å¯¹åº”çš„å…³ç³»ï¼Œå¦‚æœè¦ä¿è¯ $Y\leq y_0$ çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ $X\leq F^{-1}(y_0)=x_0$
5. é‚£ä¹ˆå¯¹åº”çš„æ¦‚ç‡å…³ç³»å°±æ˜¯ $G(y)=Pr(Y\leq y)=Pr(X\leq x_0)=F(x_0)=y$
Q.E.D

çœ‹èµ·æ¥å¾ˆç¥å¥‡çš„ä¸€ä¸ªç»“è®ºï¼Œå°±è¢«æˆ‘ä»¬è¿™ä¹ˆè¯æ˜äº†ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯å¯¹äºè¿ç»­éšæœºå˜é‡ï¼Œå…¶c.d.f.åçš„å˜é‡å¯ä»¥å’ŒåŸå§‹å˜é‡äº§ç”Ÿä¸€ä¸ªä¸€å¯¹ä¸€æ»¡å°„çš„å…³ç³»ï¼Œç»§ç»­è¿›è¡Œc.d.fçš„è®¡ç®—å°±èƒ½å¾—åˆ°ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„c.d.f

ä¸Šé¢çš„ç»“è®ºè¿›ä¸€æ­¥ç²¾ç®€å°±æ˜¯ä»»æ„è¿ç»­åˆ†å¸ƒçš„c.d.f. å‡½æ•° $F$ çš„c.d.f.å‡½æ•° $F$ å°±æ˜¯å‡åŒ€åˆ†å¸ƒï¼Œé‚£ä¹ˆä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„ $F^{-1}$ å°±æ˜¯ä¸€ä¸ªä»»æ„è¿ç»­åˆ†å¸ƒçš„c.d.fï¼ˆ $F$ ï¼‰

>Corollary Let $Y$ have the uniform distribution on the interval $[0,1]$ ,and let $F$ be a continuous  c.d.f. with quanntile function $F^{-1}$.Then $X=F^{-1}(Y)$ has c.d.f. $F$

ä¸Šé¢çš„å®šç†ç»™æˆ‘ä»¬äº†ä¸€ä¸ªé‡è¦çš„å¼•ç”¨ç»“è®ºï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•é€šè¿‡å‡åŒ€ç”Ÿæˆä»»æ„çš„åˆ†å¸ƒçš„éšæœºå˜é‡

## æ¨¡æ‹Ÿéšæœº Simulation
ä¸Šé¢çš„ç»“è®ºå¸®åŠ©æˆ‘ä»¬ä»¿çœŸç”Ÿæˆéšæœºæ•°ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬çš„è®¡ç®—æœºä¸Šç”¨äºç”Ÿæˆéšæœºæ•°çš„ç®—æ³•æ˜¯ä¼ªéšæœºçš„ï¼Œç”¨çš„æ˜¯å‘¨æœŸéå¸¸å¤§çš„ä¸€ä¸ªå‡½æ•°æ¥å‡è£…ç”Ÿæˆå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ç‰¹å®šåˆ†å¸ƒçš„éšæœºæ•°ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨ä¸Šé¢çš„åŸç†å°†å‡åŒ€åˆ†å¸ƒçš„éšæœºå˜é‡è½¬æ¢æˆä»»æ„åˆ†å¸ƒçš„éšæœºå˜é‡äº†ã€‚
å¦‚æœéå¸¸è¯¦ç»†çš„æè¿°è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºè¿™ä¸ªè¯¾é¢˜åœ¨CSå’Œæ•°å­¦ç•Œå·²ç»å‘å±•æˆä¸€ä¸ªä¸“é—¨çš„è¯¾é¢˜äº†ï¼Œæˆ‘æ²¡åŠæ³•ç”¨æˆ‘ç›®å‰çš„çŸ¥è¯†å»è®²è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§æ¦‚çŸ¥é“ä¸‹ä»»æ„åˆ†å¸ƒçš„éšæœºå˜é‡çš„ç”Ÿæˆï¼š
1. ä½¿ç”¨ç³»ç»Ÿapiç”Ÿæˆè‹¥å¹²ä¸ªå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•° $\vec{x}$
2. æ±‚ç›®æ ‡åˆ†å¸ƒçš„c.d.fçš„é€†å‡½æ•° $F^{-1}$
3. æ±‚ç›®æ ‡c.d.f.åˆ†å¸ƒçš„éšæœºå˜é‡ $F^{-1}(\vec{x})$
ä¸Šé¢è¿™ç§ç®—æ³•è¢«å«åšåˆ†ä½æ•°æ³•ï¼Œå½“ç„¶æˆ‘ä»¬ç°åœ¨å¤§éƒ¨åˆ†è½¯ä»¶ä¸­ç”¨çš„éƒ½æ˜¯æ›´é«˜çº§çš„ç®—æ³•ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªå·±å»æŸ¥èµ„æ–™ã€‚
## æ€»ç»“
æœ¬æ–‡ä¸»è¦ä»‹ç»å•ä¸ªéšæœºå˜é‡çš„å‡½æ•°ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹æ˜¯è¿ç»­éšæœºå˜é‡çš„c.d.fçš„c.d.fæ˜¯å‡åŒ€åˆ†å¸ƒï¼Œè¿™ä¸ªåœ¨åé¢çš„åº”ç”¨ä¸­ä¼šç»å¸¸ç”¨åˆ°ï¼Œæ¨ç†è¿‡ç¨‹éƒ½å¾ˆç²—ç³™ï¼Œå› ä¸ºæœ¬ç¯‡çš„å†…å®¹å®åœ¨å¤ªæ·±å¥¥ï¼Œè¿™é‡Œåªèƒ½æ˜¯ç›²äººæ‘¸è±¡ä¸€æ ·ç»™å‡ºè‡ªå·±çš„ç†è§£ï¼Œæˆ‘ä»¬ä¸‹ä¸€ç¯‡ç»§ç»­ã€‚ã€‚





åŸæ–‡åœ°å€1ï¼š[https://www.face2ai.com/Math-Probability-3-8-Fuctions-of-a-Random-Variable](https://www.face2ai.com/Math-Probability-3-8-Fuctions-of-a-Random-Variable)è½¬è½½è¯·æ ‡æ˜å‡ºå¤„
